function test_polyhedron_setdiff_02_pass
%
% set difference between two full-dimensional polyhedra- 3 D case
%

H1 = [0.10487      -1.7947      0.73936      0.53834
      0.72225      0.84038       1.7119      0.99613
       2.5855     -0.88803     -0.19412     0.078176
     -0.66689      0.10009      -2.1384      0.44268
      0.18733     -0.54453     -0.83959      0.10665
    -0.082494      0.30352       1.3546       0.9619
       -1.933     -0.60033      -1.0722    0.0046342
     -0.43897      0.48997      0.96095      0.77491];

P = Polyhedron('H',H1);

H2 = [-0.13322        2.526      -2.3299      0.74469
     -0.71453       1.6555      -1.4491      0.18896
       1.3514      0.30754      0.33351      0.68678
     -0.22477      -1.2571      0.39135      0.18351
     -0.58903     -0.86547      0.45168      0.36848
     -0.84793      0.79142      0.18369      0.78023
      -1.1201       -1.332     -0.47615     0.081126];

Q = Polyhedron('H',H2);

R = P\Q;

% R is an array of 5 polyhedra in 3D

H{1} = [0.72225      0.84038       1.7119      0.99613
       2.5855     -0.88803     -0.19412     0.078176
     -0.66689      0.10009      -2.1384      0.44268
      0.18733     -0.54453     -0.83959      0.10665
       -1.933     -0.60033      -1.0722    0.0046342
     -0.43897      0.48997      0.96095      0.77491
      0.13322       -2.526       2.3299     -0.74469];

H{2} = [0.72225      0.84038       1.7119      0.99613
       2.5855     -0.88803     -0.19412     0.078176
       -1.933     -0.60033      -1.0722    0.0046342
     -0.43897      0.48997      0.96095      0.77491
     -0.13322        2.526      -2.3299      0.74469
      0.71453      -1.6555       1.4491     -0.18896];  

H{3} = [0.10487      -1.7947      0.73936      0.53834
      0.72225      0.84038       1.7119      0.99613
       2.5855     -0.88803     -0.19412     0.078176
    -0.082494      0.30352       1.3546       0.9619
       -1.933     -0.60033      -1.0722    0.0046342
     -0.43897      0.48997      0.96095      0.77491
      0.22477       1.2571     -0.39135     -0.18351];  

H{4} = [-1.933     -0.60033      -1.0722    0.0046342
     -0.43897      0.48997      0.96095      0.77491
     -0.22477      -1.2571      0.39135      0.18351
      0.58903      0.86547     -0.45168     -0.36848];

H{5} = [2.5855     -0.88803     -0.19412     0.078176
       -1.933     -0.60033      -1.0722    0.0046342
     -0.22477      -1.2571      0.39135      0.18351
       1.1201        1.332      0.47615    -0.081126];
  
% since the result can be arbitrarily ordered, we need to test each combination 
ts = false(5);
for i=1:5
    for j=1:5
      ts(i,j) = Polyhedron('H',H{i}) == R(j);
    end
end

if any(sum(ts,2)>1)
    error('Here should be 5 regions.');
end

end