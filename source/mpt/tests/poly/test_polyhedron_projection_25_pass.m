function test_polyhedron_projection_25_pass
% projection of unbounded polyhedra must work (issue #114)

%%
% non-negative quadrant in R^2 -> R^1
P = Polyhedron(-eye(2), zeros(2, 1));
Q = P.projection(1);
Qexp = Polyhedron(-1, 0);
assert(Q==Qexp);

% force the mplp method
P = Polyhedron(-eye(2), zeros(2, 1));
Q = P.projection(1, 'mplp');
Qexp = Polyhedron(-1, 0);
assert(Q==Qexp);

%%
% non-negative quadrant in R^13 -> R^1 (default projection method)
P = Polyhedron(-eye(13), zeros(13, 1));
Q = P.projection(1);
Qexp = Polyhedron(-1, 0);
assert(Q==Qexp);

% force the mplp method
P = Polyhedron(-eye(13), zeros(13, 1));
Q = P.projection(1, 'mplp');
Qexp = Polyhedron(-1, 0);
assert(Q==Qexp);

%%
% non-negative quadrant in R^13 -> R^2 (default projection method)
P = Polyhedron(-eye(13), zeros(13, 1));
Q = P.projection(1:2);
Qexp = Polyhedron(-eye(2), zeros(2, 1));
assert(Q==Qexp);

% force the mplp method
P = Polyhedron(-eye(13), zeros(13, 1));
Q = P.projection(1:2, 'mplp');
Qexp = Polyhedron(-eye(2), zeros(2, 1));
assert(Q==Qexp);

%% tricky case in R^13 (issue #114)
A = [0 0 0 -0.110125851387856 0 0.190743569830546 0 0.269752143389818 0 -0.110125851387856 0 1.016363211356 0.0163632113560014;-0.5 0 0 0.496635647709297 0 -0.705497636303129 0 -0.290617544295499 0 -0.503364352290703 0 0.205497636303129 0.205497636303129;0 -0.5 -0.290617544295499 0 0.496635647709297 0 -0.705497636303129 0 -0.290617544295499 0 -0.503364352290703 0 0;0.5 0 0 0.963860065511067 0 0.485245933527417 0 -0.0208654009056808 0 -0.0361399344889329 0 0.0147540664725829 0.0147540664725829;0 0.5 -0.0208654009056808 0 0.963860065511067 0 0.485245933527417 0 -0.0208654009056808 0 -0.0361399344889329 0 0;0 0 0.15574147260059 -0.620122005222326 -0.730247856610182 -0.0806177184426902 0.110125851387856 -0.114010670789228 0.15574147260059 0.379877994777674 0.269752143389818 -0.626489062743857 -0.626489062743857;0 0 0.269752143389818 0 -0.110125851387856 0 0.190743569830546 0 -0.730247856610182 0 -0.110125851387856 -0.333333333333333 0.333333333333333;-0.5 0 -0.269752143389818 0.233612208900885 0.110125851387856 0.595371784915273 -0.190743569830546 0.134876071694909 0.730247856610182 0.233612208900885 0.110125851387856 -0.095371784915273 -0.095371784915273;0 -0.5 -0.134876071694909 0 0.343738060288741 0 0.404628215084727 0 0.865123928305091 0 0.343738060288741 0 0;0.5 0 -0.269752143389818 -0.233612208900885 0.110125851387856 -0.595371784915273 -0.190743569830546 -0.134876071694909 0.730247856610182 -0.233612208900885 0.110125851387856 0.095371784915273 0.095371784915273;0 0.5 -0.404628215084727 0 -0.123486357513029 0 -0.786115354745819 0 0.595371784915273 0 -0.123486357513029 0 0;0 0 0 0 0 0 0 0 0 0 0 0.5 -0.5;0 0 0 0 0 0 0 0 0 0 0 -0.5 0.5];
b = [0.5;0;0;0;0;0;0.333333333333333;0;0;0;0;0.5;0.5];
P=Polyhedron(A,b);
projection(P, 1:2); % this used to fail
projection(P, 1:2, 'mplp'); % this used to fail


end
