function test_polyhedron_setdiff_09_pass
%
% set difference between full dimensional polyhedron and 
% full-dim, unbounded, low-dim, empty polyhedra in 2D
%


H1 = [    -0.69218      -1.4951      0.38786
        1.435      0.80287      0.27145
      0.73858       1.5862      0.44787
      0.66116     0.039702      0.17412
      -1.7296      -1.3799       0.2446
      -2.1381       1.2331      0.64093
       1.3857      -2.0015      0.85337];

% full-dim
P = Polyhedron('H',H1);

% full-dim
Pn(1) = Polyhedron('H',[0.61797, 0.68633, 1.2992; -1.3443, 1.7073, 0.15845; -0.071106, 0.92949, 0.72722; 0.57407, -1.1832, 0.064229]);

% unbounded
Pn(2) = Polyhedron('lb',[0;0]);

% low-dim
Pn(3)=Polyhedron('He',[2 -0.5/0.7 0],'lb',[-0.5;-0.4],'ub',[0.5;0.8]);

% infeasible 
Hinfeas = [-0.38934       1.8573      0.12079
      -1.2717      0.30954     -0.51591
       0.2726      -0.4891     -0.34086
      0.31747     -0.69488        -1.08
       1.4984     -0.18039     -0.69739
      -1.5538       1.2563       -0.583
     -0.35429       1.9107     -0.18613
      0.43423     0.027193      0.58796
     -0.10148      0.42713    -0.021041
       2.0288      0.32336    -0.079761
     -0.36721       -1.649     -0.83551
      -2.3638      0.14034      0.97862
      0.72986     -0.49804      0.23548
       -1.399     -0.42777      0.56605
       1.3149     -0.15087      0.21929
      0.40383      -2.8908      0.80771
     -0.34417     -0.73454       1.5125
     -0.98006      0.75622     -0.43163];

Pn(4) = Polyhedron('H',Hinfeas);

R = P\Pn;
% result are 4 full-dim polytopes
H{1} = [0.73858       1.5862      0.44787
      -1.7296      -1.3799       0.2446
      -2.1381       1.2331      0.64093
       1.3443      -1.7073     -0.15845
            1            0            0];

H{2} = [   1.0000         0         0
        -8.93786295909947          18.4215852652229    -1.0000
        -7.07113654946852          -5.6414554374489    1.0000 ];


H{3} = [-0.69218      -1.4951      0.38786
        1.435      0.80287      0.27145
      0.66116     0.039702      0.17412
      -1.7296      -1.3799       0.2446
       1.3857      -2.0015      0.85337
     -0.57407       1.1832    -0.064229
           -1            0            0
            0            1            0];
     
% since the result can be arbitrarily ordered, we need to test each combination 
ts = false(3);
for i=1:3
    for j=1:3
      ts(i,j) = Polyhedron('H',H{i}) == R(j);
    end
end

if any(sum(ts,2)>1)
    error('Here should be 4 non-overlapping regions.');
end

end
