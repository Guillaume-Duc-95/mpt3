function test_plcp_07_pass
%  LCP solution is defined over all feasible area given in Ath, bth
% it happened that some regions were missing 

%% input data
% w - M*z = q + Q*th


load data_test_plcp_07

% solve
res = problem.solve;

if res.xopt.Num~=15
    error('Here must be 15 regions.');
end

H{1} = [
  -0.931352462133839  -0.364118924634845   0.393290335897277
  -0.827903633111546   0.560870372083161  -0.335038152662962
   0.897777690087740  -0.440448883731952   0.241655088454860];

H{2} = [
   0.931352462133839   0.364118924634845  -0.393290335897277
  -0.847578610069838   0.530669859472046  -0.309308137677609
   0.890925529511013  -0.454149425702071   0.253193439034054
                   0  -1.000000000000000   5.000000000000000];

H{3} = [
   0.827903633111546  -0.560870372083161   0.335038152662962
  -0.297778495611856   0.954634991790653   0.017983072053519
  -0.972349706099090  -0.233529546415465   0.297119586695694
   0.969997372785368  -0.243115398092108   0.092291547627181];

H{4} = [
 -0.897777690087740   0.440448883731952  -0.241655088454860
   0.268311097164868   0.963332318121937   0.213287379393462
  -0.891723425201817  -0.452580747432256   0.458093050428099
  -0.233938222210279   0.972251463454334  -0.684822963019789
   1.000000000000000                   0   5.000000000000000
                   0  -1.000000000000000   5.000000000000000];

H{5} = [
 -0.730908532185504   0.682475433681266   0.408002172374074
   0.972349706099090   0.233529546415465  -0.297119586695694
   0.847578610069838  -0.530669859472046   0.309308137677609
  -0.522209309284033   0.852817352835350   0.089971221477068
  -1.000000000000000                   0   5.000000000000000
                   0  -1.000000000000000   5.000000000000000];

H{6} = [
   0.891723425201817   0.452580747432256  -0.458093050428099
  -0.890925529511013   0.454149425702071  -0.253193439034055
                   0  -1.000000000000000   5.000000000000000];
        
H{7} = [
   0.297778495611856  -0.954634991790653  -0.017983072053519
  -0.949489201492976   0.313799707215017   0.441709487549102
  -0.981897457490098  -0.189413259764151   0.296735146150387
   0.979836588829363  -0.199800548525867   0.095637217280961];

H{8} = [
  0.233938222210279  -0.972251463454334   0.684822963019789
  -0.969997372785368   0.243115398092108  -0.092291547627181
   0.192127882736329   0.981369897987123   0.072465356679895];

H{9} = [
 -0.268311097164868  -0.963332318121937  -0.213287379393462
  -0.199151398740964   0.979968734388765  -0.624912476426307
   1.000000000000000                   0   5.000000000000000];

H{10} = [
  -0.594691929834656   0.803953673161292   0.194743240201039
   0.730908532185504  -0.682475433681266  -0.408002172374074
  -1.000000000000000                   0   5.000000000000000];

H{11} = [
   0.522209309284033  -0.852817352835350  -0.089971221477068
  -0.771810282671014   0.635852882012255   0.477636378361035
   0.981897457490098   0.189413259764151  -0.296735146150387];

H{12} = [
   0.949489201492976  -0.313799707215017  -0.441709487549102
  -0.999116352334100  -0.042029923847205   0.348872738908275
   0.971033253705335  -0.238944387250320  -0.087247364504160
                   0   1.000000000000000   5.000000000000000];

H{13} = [
  -0.192127882736329  -0.981369897987123  -0.072465356679895
  -0.378521081481379   0.925592670062899   3.735298074325407
   0.199151398740964  -0.979968734388765   0.624912476426307
  -0.979836588829363   0.199800548525867  -0.095637217280961
   1.000000000000000                   0   5.000000000000000
                   0   1.000000000000000   5.000000000000000];

H{14} = [
   0.594691929834656  -0.803953673161291  -0.194743240201039
   0.999116352334100   0.042029923847205  -0.348872738908275
   0.771810282671014  -0.635852882012254  -0.477636378361035
                   0   1.000000000000000   5.000000000000000
  -1.000000000000000                   0   5.000000000000000];

H{15} = [
  -0.971033253705335   0.238944387250320   0.087247364504160
   0.378521081481379  -0.925592670062899  -3.735298074325407
                   0   1.000000000000000   5.000000000000000];
   
             
ts = false(15,1);
for i=1:15
    P = Polyhedron('H',H{i});
    for j=1:res.xopt.Num
        if P == res.xopt.Set(j);
            ts(i) = true;
            break;
        end        
    end  
end
       
if ~all(ts)
    error('Regions do not fit.');
end


end