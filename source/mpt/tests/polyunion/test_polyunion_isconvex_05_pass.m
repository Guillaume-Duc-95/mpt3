function test_polyunion_isconvex_05_pass
%
% 69 regions from test_plcp_02
%
% Very interesting example. If the lb/ub are not provided, the result is
% 198 regions due to differnt factorization scheme when doing MPQP->PLCP
% transformation. If lb/ub are provided, the result is 69 regions. Both
% results give the same objective value and the solution.

H = [
       311.78       271.22       233.15       196.09       160.53       126.97       95.906       67.844       43.281       22.719
       271.22       242.06        207.4       175.24       144.08       114.43       86.769       61.611       39.453       20.795
       233.15        207.4       183.65       154.39       127.64       101.89       77.632       55.379       35.625       18.871
       196.09       175.24       154.39       135.54       111.19       89.345       68.496       49.146       31.797       16.947
       160.53       144.08       127.64       111.19       96.749       76.804       59.359       42.914       27.969       15.023
       126.97       114.43       101.89       89.345       76.804       66.263       50.222       36.681        24.14       13.099
       95.906       86.769       77.632       68.496       59.359       50.222       43.085       30.449       20.312       11.175
       67.844       61.611       55.379       49.146       42.914       36.681       30.449       26.216       16.484       9.2514
       43.281       39.453       35.625       31.797       27.969        24.14       20.312       16.484       14.656       7.3274
       22.719       20.795       18.871       16.947       15.023       13.099       11.175       9.2514       7.3274       7.4035
];

F = [
      74.124       62.316       51.507       41.699        32.89       25.082       18.273       12.465       7.6564        3.848
       545.43       480.12        414.8       350.48       288.17       228.85       173.54       123.22       78.906       41.591
];

G = [
            0            0            0            0            0            0            0            0            0            0
            0            0            0            0            0            0            0            0            0            0
            1            0            0            0            0            0            0            0            0            0
           -1            0            0            0            0            0            0            0            0            0
      0.57735            0            0            0            0            0            0            0            0            0
     -0.57735            0            0            0            0            0            0            0            0            0
            0            1            0            0            0            0            0            0            0            0
            0           -1            0            0            0            0            0            0            0            0
      0.52223      0.34816            0            0            0            0            0            0            0            0
     -0.52223     -0.34816            0            0            0            0            0            0            0            0
            0            0            1            0            0            0            0            0            0            0
            0            0           -1            0            0            0            0            0            0            0
      0.48154      0.36116      0.24077            0            0            0            0            0            0            0
     -0.48154     -0.36116     -0.24077            0            0            0            0            0            0            0
            0            0            0            1            0            0            0            0            0            0
            0            0            0           -1            0            0            0            0            0            0
      0.45268      0.36214      0.27161      0.18107            0            0            0            0            0            0
     -0.45268     -0.36214     -0.27161     -0.18107            0            0            0            0            0            0
            0            0            0            0            1            0            0            0            0            0
            0            0            0            0           -1            0            0            0            0            0
      0.43077      0.35898      0.28718      0.21539      0.14359            0            0            0            0            0
     -0.43077     -0.35898     -0.28718     -0.21539     -0.14359            0            0            0            0            0
            0            0            0            0            0            1            0            0            0            0
            0            0            0            0            0           -1            0            0            0            0
       0.4132      0.35417      0.29514      0.23611      0.17708      0.11806            0            0            0            0
      -0.4132     -0.35417     -0.29514     -0.23611     -0.17708     -0.11806            0            0            0            0 ];

E = [
           -1            0
            1            0
            0            0
            0            0
     -0.57735     -0.57735
      0.57735      0.57735
            0            0
            0            0
     -0.34816     -0.69631
      0.34816      0.69631
            0            0
            0            0
     -0.24077     -0.72232
      0.24077      0.72232
            0            0
            0            0
     -0.18107     -0.72429
      0.18107      0.72429
            0            0
            0            0
     -0.14359     -0.71796
      0.14359      0.71796
            0            0
            0            0
     -0.11806     -0.70834
      0.11806      0.70834 ];

W = [
           10
           10
            1
            1
       5.7735
       5.7735
            1
            1
       3.4816
       3.4816
            1
            1
       2.4077
       2.4077
            1
            1
       1.8107
       1.8107
            1
            1
       1.4359
       1.4359
            1
            1
       1.1806
       1.1806  ];

% define problem
problem = Opt('H',H,'pF',F','A',G,'b',W,'pB',E,'lb',-10*ones(10,1),'ub',10*ones(10,1));

% transform to LCP
% problem.qp2lcp;

% solve
res = problem.solve;

% the first check must be true, because there is convexity flag stored
% internally
PU = res.xopt;

if ~PU.isConvex
    error('PU must be convex.');
end

% create new partition without any flags 
T = PolyUnion(PU.Set);

% check again
if ~T.isConvex
    error('PU must be convex.');
end


end
