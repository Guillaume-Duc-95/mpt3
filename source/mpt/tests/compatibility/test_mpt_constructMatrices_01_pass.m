function test_mpt_constructMatrices_01_pass

Double_Integrator;
M = mpt_constructMatrices(sysStruct, probStruct);
assert(isequal(size(M.G), [20 5]));
assert(isequal(size(M.W), [20 1]));
assert(isequal(size(M.E), [20 2]));
assert(isequal(size(M.H), [5 5]));
assert(isequal(size(M.F), [2 5]));
assert(isequal(size(M.Y), [2 2]));
assert(isequal(size(M.Cf), [1 5]));
assert(isequal(size(M.Cx), [1 2]));
assert(isfield(M, 'Pinvset'));

Mgood.H = [66.2630786665808 50.2221592494119 36.681239832243 24.1403204150741 13.0994009979051;50.2221592494119 43.0854729141863 30.4487865789607 20.3121002437351 11.1754139085095;36.681239832243 30.4487865789607 26.2163333256784 16.4838800723961 9.2514268191138;24.1403204150741 20.3121002437351 16.4838800723961 14.6556599010571 7.32743972971813;13.0994009979051 11.1754139085095 9.2514268191138 7.32743972971813 7.40345264032246];
Mgood.Y = [6.80846616388663 19.2733726704512;19.2733726704512 85.1709458283726];
Mgood.F = [25.0818388343378 18.2733726704512 12.4649065065646 7.65644034267797 3.84797417879134;103.444318498824 82.1709458283726 60.8975731579214 40.6242004874702 22.3508278170189];
Mgood.Y = [6.80846616388663 19.2733726704512;19.2733726704512 85.1709458283726];
Mgood.Cf = [0 0 0 0 0];
Mgood.Cx = [0 0];
Mgood.Cc = 0;
Mgood.W = [5;5;1;1;2.88675134594813;2.88675134594813;1;1;1.74077655955698;1.74077655955698;1;1;1.20385853085769;1.20385853085769;1;1;1;1;0.200558936874431;0.200558936874431];
Mgood.E = [-1 -0;1 0;-0 -0;0 0;-0.577350269189626 -0.577350269189626;0.577350269189626 0.577350269189626;0 0;0 0;-0.348155311911396 -0.696310623822791;0.348155311911396 0.696310623822791;0 0;0 0;-0.240771706171538 -0.722315118514615;0.240771706171538 0.722315118514615;0 0;0 0;0 0;0 0;0.10424131117087 0.709723439986046;-0.10424131117087 -0.709723439986046];
Mgood.G = [0 0 0 0 0;-0 0 0 0 0;1 0 0 0 0;-1 0 0 0 0;0.577350269189626 0 0 0 0;-0.577350269189626 -0 0 0 0;0 1 0 0 0;0 -1 0 0 0;0.522232967867094 0.348155311911396 0 0 0;-0.522232967867094 -0.348155311911396 -0 0 0;0 0 1 0 0;0 0 -1 0 0;0.481543412343077 0.361157559257308 0.240771706171538 0 0;-0.481543412343077 -0.361157559257308 -0.240771706171538 -0 0;0 0 0 1 0;0 0 0 -1 0;0 0 0 0 1;0 0 0 0 -1;-0.406982375578458 -0.354861719993023 -0.302741064407588 -0.250620408822153 -0.198499753236718;0.406982375578458 0.354861719993023 0.302741064407588 0.250620408822153 0.198499753236718];

% test correctness of each field
f = fieldnames(Mgood);
for i = 1:length(f)
	actual = M.(f{i});
	good = Mgood.(f{i});
	assert(norm(actual-good)<1e-10);
end

end
